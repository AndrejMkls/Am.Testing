@page "/authors/create/v1"

@using Am.Testing.Domain.Entities

@inherits BasePage
@inject IStringLocalizer<CreateAuthorPageV1> Localizer
@inject MainDbContext DbContext 

<h3>@Localizer["CreateNewItem"] Vytvoriť novú položku</h3>

<RadzenCard>

    <RadzenTemplateForm Data="@item" Submit="@(async (Author args) => { await OnSubmit(args); })">

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["FirstName"]" />
            </div>
            <div class="col-xl-6 col-12">
                <RadzenTextBox Name="FirstName" @bind-Value=@item.FirstName class="w-100" />
                <RadzenRequiredValidator Component="FirstName" Text="First name is required" Popup=@popup Style="position: absolute" />
                <RadzenLengthValidator Component="FirstName" Max="50" Text="First name should be at most 10 characters" Popup=@popup Style="position: absolute" />
            </div>
        </div>

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["LastName"]" />
            </div>
            <div class="col-xl-6 col-12">
                <RadzenTextBox Name="LastName" @bind-Value=@item.LastName class="w-100" />
                <RadzenRequiredValidator Component="LastName" Text="Last name is required" Popup=@popup Style="position: absolute" />
                <RadzenLengthValidator Component="LastName" Max="50" Text="First name should be at most 10 characters" Popup=@popup Style="position: absolute" />
            </div>
        </div>

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["FullName"]" />
            </div>
            <div class="col-xl-6 col-12">
                <RadzenTextBox @bind-Value=@item.FullName class="w-100" />
            </div>
        </div>

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["Biography"]" />
            </div>
            <div class="col-xl-6 col-12">
                <RadzenTextArea @bind-Value=@item.Biography class="w-100" />
            </div>
        </div>

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["Nationality"]" />
            </div>
            <div class="col-xl-6 col-12">
                <RadzenTextBox @bind-Value=@item.Nationality class="w-100" />
            </div>
        </div>

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["Photo"]" />
            </div>
            <div class="col-xl-6 col-12">
                <InputFile />
            </div>
        </div>

        <div class="row mb-1">
            <div class="col-xl-3 col-12">
                <RadzenLabel Text="@Localizer["BirthYear"]" />
            </div>
            <div class="col-xl-6 col-12">
                <RadzenNumeric Name="BirthYear" @bind-Value=@item.BirthYear class="w-100" />
                <RadzenNumericRangeValidator Component="BirthYear" Max="@DateTime.Now.Year" Text="Text" Popup=@popup Style="position: absolute" />
            </div>
        </div>

        <RadzenButton ButtonType="ButtonType.Submit" Size="ButtonSize.Large" Icon="save" Text="Save" />
        <RadzenButton ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Large" Icon="cancel" Text="Cancel" Click="@Cancel" />

    </RadzenTemplateForm>

</RadzenCard>

@code {


    private Author item = new();


    private async Task OnSubmit(Author output)
    {
        await DbContext.Authors.AddAsync(output);
        await DbContext.SaveChangesAsync();

        Navigations.NavigateTo("/authors/index/v1");
    }

    void Cancel()
    {
        //
    }



}
